<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Classificazione del Movimento e Rilevamento delle Anomalie – Machine Learning Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../../contents/labs/seeed/xiao_esp32s3/xiao_esp32s3.it.html" rel="next">
<link href="../../../../../contents/labs/arduino/nicla_vision/kws/kws.it.html" rel="prev">
<link href="../../../../../favicon.png" rel="icon" type="image/png">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "~",
    "/"
  ],
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-M21L0CBCVN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-M21L0CBCVN', { 'anonymize_ip': true});
</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-M21L0CBCVN"></script>
<script src="../../../../../scripts/ai_menu/dist/bundle.js" defer=""></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Machine Learning Systems</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-wide tools-end">
    <a href="https://github.com/harvard-edge/cs249r_book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../../../../../Machine-Learning-Systems.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Attiva/disattiva la modalità oscura"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../contents/labs/arduino/nicla_vision/nicla_vision.it.html">Nicla Vision</a></li><li class="breadcrumb-item"><a href="../../../../../contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.html">Classificazione del Movimento e Rilevamento delle Anomalie</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/copyright.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Copyright</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/dedication.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dedica</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/acknowledgements/acknowledgements.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ringraziamenti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/contributors.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collaboratori e Ringraziamenti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/about.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni sul Libro</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/introduction/introduction.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduzione</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/ml_systems/ml_systems.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Sistemi di ML</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/dl_primer/dl_primer.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Avvio al Deep Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/workflow/workflow.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Workflow dell’IA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/data_engineering/data_engineering.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Engineering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/frameworks/frameworks.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Framework di IA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/training/training.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Addestramento dell’IA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/efficient_ai/efficient_ai.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">IA Efficiente</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/optimizations/optimizations.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Ottimizzazioni dei Modelli</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/hw_acceleration/hw_acceleration.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Accelerazione IA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/benchmarking/benchmarking.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Benchmarking dell’IA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/ondevice_learning/ondevice_learning.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Apprendimento On-Device</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/ops/ops.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operazioni di ML</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/privacy_security/privacy_security.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Sicurezza e Privacy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/responsible_ai/responsible_ai.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">IA Responsabile</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/sustainable_ai/sustainable_ai.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">IA Sostenibile</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/robust_ai/robust_ai.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">IA Robusta</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/generative_ai/generative_ai.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">IA Generativa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/ai_for_good/ai_for_good.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">AI for Good</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/core/conclusion/conclusion.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Conclusione</span></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../contents/labs/labs.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LABORATORI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/part_LABS.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">LABORATORI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/overview.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Panoramica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/getting_started.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guida Introduttiva</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../contents/labs/arduino/nicla_vision/nicla_vision.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nicla Vision</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/arduino/nicla_vision/part_nicla_vision.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">part_nicla_vision.it.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/arduino/nicla_vision/setup/setup.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/arduino/nicla_vision/image_classification/image_classification.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classificazione delle Immagini</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/arduino/nicla_vision/object_detection/object_detection.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rilevamento degli Oggetti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/arduino/nicla_vision/kws/kws.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Keyword Spotting (KWS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Classificazione del Movimento e Rilevamento delle Anomalie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../contents/labs/seeed/xiao_esp32s3/xiao_esp32s3.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XIAO ESP32S3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/seeed/xiao_esp32s3/part_xiao_esp32s3.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">part_xiao_esp32s3.it.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/seeed/xiao_esp32s3/setup/setup.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/seeed/xiao_esp32s3/image_classification/image_classification.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classificazione delle Immagini</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/seeed/xiao_esp32s3/object_detection/object_detection.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rilevamento degli Oggetti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/seeed/xiao_esp32s3/kws/kws.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Keyword Spotting (KWS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/seeed/xiao_esp32s3/motion_classification/motion_classification.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classificazione del Movimento e Rilevamento delle Anomalie</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../contents/labs/raspi/raspi.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Raspberry Pi</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/raspi/part_raspi.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">part_raspi.it.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/raspi/setup/setup.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/raspi/image_classification/image_classification.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classificazione delle Immagini</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/raspi/object_detection/object_detection.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rilevamento degli Oggetti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/raspi/llm/llm.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Small Language Models (SLM)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../contents/labs/shared/shared.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Condivisi</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/shared/part_shared.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">part_shared.it.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/shared/kws_feature_eng/kws_feature_eng.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KWS Feature Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../contents/labs/shared/dsp_spectral_features_block/dsp_spectral_features_block.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blocco delle Feature Spettrali DSP</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">RIFERIMENTI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../references.it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riferimenti</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice</h2>
   
  <ul>
  <li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione">Introduzione</a></li>
  <li><a href="#installazione-e-test-dellimu" id="toc-installazione-e-test-dellimu" class="nav-link" data-scroll-target="#installazione-e-test-dellimu">Installazione e test dell’IMU</a>
  <ul>
  <li><a href="#definizione-della-frequenza-di-campionamento" id="toc-definizione-della-frequenza-di-campionamento" class="nav-link" data-scroll-target="#definizione-della-frequenza-di-campionamento">Definizione della Frequenza di Campionamento:</a></li>
  </ul></li>
  <li><a href="#il-caso-di-studio-trasporto-simulato-di-container" id="toc-il-caso-di-studio-trasporto-simulato-di-container" class="nav-link" data-scroll-target="#il-caso-di-studio-trasporto-simulato-di-container">Il Caso di Studio: Trasporto Simulato di Container</a></li>
  <li><a href="#raccolta-dati" id="toc-raccolta-dati" class="nav-link" data-scroll-target="#raccolta-dati">Raccolta Dati</a>
  <ul>
  <li><a href="#collegamento-del-dispositivo-a-edge-impulse" id="toc-collegamento-del-dispositivo-a-edge-impulse" class="nav-link" data-scroll-target="#collegamento-del-dispositivo-a-edge-impulse">Collegamento del dispositivo a Edge Impulse</a></li>
  <li><a href="#raccolta-dati-1" id="toc-raccolta-dati-1" class="nav-link" data-scroll-target="#raccolta-dati-1">Raccolta Dati</a></li>
  </ul></li>
  <li><a href="#impulse-design" id="toc-impulse-design" class="nav-link" data-scroll-target="#impulse-design">Impulse Design</a>
  <ul>
  <li><a href="#panoramica-sulla-pre-elaborazione-dei-dati" id="toc-panoramica-sulla-pre-elaborazione-dei-dati" class="nav-link" data-scroll-target="#panoramica-sulla-pre-elaborazione-dei-dati">Panoramica sulla Pre-Elaborazione dei Dati</a></li>
  <li><a href="#feature-spettrali-di-ei-studio" id="toc-feature-spettrali-di-ei-studio" class="nav-link" data-scroll-target="#feature-spettrali-di-ei-studio">Feature Spettrali di EI Studio</a></li>
  <li><a href="#generazione-di-feature" id="toc-generazione-di-feature" class="nav-link" data-scroll-target="#generazione-di-feature">Generazione di feature</a></li>
  </ul></li>
  <li><a href="#addestramento-dei-modelli" id="toc-addestramento-dei-modelli" class="nav-link" data-scroll-target="#addestramento-dei-modelli">Addestramento dei Modelli</a></li>
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a></li>
  <li><a href="#distribuzione" id="toc-distribuzione" class="nav-link" data-scroll-target="#distribuzione">Distribuzione</a>
  <ul>
  <li><a href="#inferenza" id="toc-inferenza" class="nav-link" data-scroll-target="#inferenza">Inferenza</a></li>
  <li><a href="#post-elaborazione" id="toc-post-elaborazione" class="nav-link" data-scroll-target="#post-elaborazione">Post-elaborazione</a></li>
  </ul></li>
  <li><a href="#conclusione" id="toc-conclusione" class="nav-link" data-scroll-target="#conclusione">Conclusione</a>
  <ul>
  <li><a href="#applicazioni-di-casi" id="toc-applicazioni-di-casi" class="nav-link" data-scroll-target="#applicazioni-di-casi">Applicazioni di Casi</a>
  <ul class="collapse">
  <li><a href="#industriale-e-manifatturiero" id="toc-industriale-e-manifatturiero" class="nav-link" data-scroll-target="#industriale-e-manifatturiero">Industriale e Manifatturiero</a></li>
  <li><a href="#assistenza-sanitaria" id="toc-assistenza-sanitaria" class="nav-link" data-scroll-target="#assistenza-sanitaria">Assistenza Sanitaria</a></li>
  <li><a href="#elettronica-di-consumo" id="toc-elettronica-di-consumo" class="nav-link" data-scroll-target="#elettronica-di-consumo">Elettronica di Consumo</a></li>
  <li><a href="#trasporti-e-logistica" id="toc-trasporti-e-logistica" class="nav-link" data-scroll-target="#trasporti-e-logistica">Trasporti e Logistica</a></li>
  <li><a href="#città-intelligenti-e-infrastrutture" id="toc-città-intelligenti-e-infrastrutture" class="nav-link" data-scroll-target="#città-intelligenti-e-infrastrutture">Città Intelligenti e Infrastrutture</a></li>
  <li><a href="#sicurezza-e-sorveglianza" id="toc-sicurezza-e-sorveglianza" class="nav-link" data-scroll-target="#sicurezza-e-sorveglianza">Sicurezza e Sorveglianza</a></li>
  <li><a href="#agricoltura" id="toc-agricoltura" class="nav-link" data-scroll-target="#agricoltura">Agricoltura</a></li>
  <li><a href="#monitoraggio-ambientale" id="toc-monitoraggio-ambientale" class="nav-link" data-scroll-target="#monitoraggio-ambientale">Monitoraggio Ambientale</a></li>
  </ul></li>
  <li><a href="#custodia-per-nicla-3d" id="toc-custodia-per-nicla-3d" class="nav-link" data-scroll-target="#custodia-per-nicla-3d">Custodia per Nicla 3D</a></li>
  </ul></li>
  <li><a href="#risorse" id="toc-risorse" class="nav-link" data-scroll-target="#risorse">Risorse</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/harvard-edge/cs249r_book/edit/dev/contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.qmd" class="toc-action"><i class="bi bi-github"></i>Modifica questa pagina</a></li><li><a href="https://github.com/harvard-edge/cs249r_book/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li><li><a href="https://github.com/harvard-edge/cs249r_book/blob/dev/contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.qmd" class="toc-action"><i class="bi empty"></i>Mostra il codice</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../contents/labs/arduino/nicla_vision/nicla_vision.it.html">Nicla Vision</a></li><li class="breadcrumb-item"><a href="../../../../../contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.html">Classificazione del Movimento e Rilevamento delle Anomalie</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Classificazione del Movimento e Rilevamento delle Anomalie</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/jpg/movement_anomaly_ini.jpg" class="img-fluid figure-img"></p>
<figcaption><em>DALL·E 3 Prompt: Illustrazione in stile fumetto anni ’50 raffigurante una sala di ricerca sul movimento. Al centro della stanza c’è un container simulato utilizzato per il trasporto di merci su camion, barche e carrelli elevatori. Il container è dettagliato con rivetti e marcature tipiche dei cassoni di carico industriali. Attorno al container, la stanza è piena di attrezzature d’epoca, tra cui un oscilloscopio, vari array di sensori e grandi rotoli di carta di dati registrati. Le pareti sono adornate con poster educativi sulla sicurezza e la logistica dei trasporti. L’atmosfera generale della stanza è nostalgica e scientifica, con un pizzico di stile industriale.</em></figcaption>
</figure>
</div>
<section id="introduzione" class="level2">
<h2 class="anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>I trasporti sono la spina dorsale del commercio globale. Milioni di container vengono trasportati ogni giorno tramite vari mezzi, come navi, camion e treni, verso destinazioni in tutto il mondo. Garantire il transito sicuro ed efficiente di questi container è un compito monumentale che richiede di sfruttare la tecnologia moderna e TinyML è senza dubbio una di queste.</p>
<p>In questo tutorial, lavoreremo per risolvere problemi reali relativi al trasporto. Svilupperemo un sistema di Motion Classification e Anomaly Detection utilizzando la scheda Arduino Nicla Vision, l’IDE Arduino e Edge Impulse Studio. Questo progetto ci aiuterà a comprendere come i container subiscono forze e movimenti diversi durante le varie fasi del trasporto, come il transito terrestre e marittimo, il movimento verticale tramite carrelli elevatori e i periodi di stazionamento nei magazzini.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Obiettivi dell’Apprendimento
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Impostazione della scheda Arduino Nicla Vision</li>
<li>Raccolta e pre-elaborazione dei dati</li>
<li>Creazione del modello di classificazione del movimento</li>
<li>Implementazione del rilevamento delle anomalie</li>
<li>Test e Analisi nel Mondo Reale</li>
</ul>
</div>
</div>
<p>Alla fine di questo tutorial, si avrà un prototipo funzionante in grado di classificare diversi tipi di movimento e rilevare anomalie durante il trasporto di container. Questa conoscenza può essere un trampolino di lancio per progetti più avanzati nel campo emergente di TinyML che coinvolge le vibrazioni.</p>
</section>
<section id="installazione-e-test-dellimu" class="level2">
<h2 class="anchored" data-anchor-id="installazione-e-test-dellimu">Installazione e test dell’IMU</h2>
<p>Per questo progetto, useremo un accelerometro. Come spiegato nel Tutorial, <em>Configurazione di Nicla Vision</em>, la Nicla Vision Board ha un <strong>IMU a 6 assi</strong> integrato: giroscopio 3D e accelerometro 3D, il <a href="https://www.st.com/resource/en/datasheet/lsm6dsox.pdf">LSM6DSOX</a>. Verifichiamo se la <a href="https://github.com/arduino-libraries/Arduino_LSM6DSOX">libreria IMU LSM6DSOX</a> è installata. In caso contrario, la si installa.</p>
<p><img src="images/jpg/imu_ide.jpg" class="img-fluid"></p>
<p>Poi si va su <code>Examples &gt; Arduino_LSM6DSOX &gt; SimpleAccelerometer</code> e si esegue il test dell’accelerometro. Si può verificare se funziona aprendo l’IDE Serial Monitor o Plotter. I valori sono in g (gravità terrestre), con un range di default di +/- 4g:</p>
<p><img src="images/jpg/imu_test.jpg" class="img-fluid"></p>
<section id="definizione-della-frequenza-di-campionamento" class="level3">
<h3 class="anchored" data-anchor-id="definizione-della-frequenza-di-campionamento">Definizione della Frequenza di Campionamento:</h3>
<p>La scelta di una frequenza di campionamento appropriata è fondamentale per catturare le caratteristiche del movimento che interessa studiare. Il teorema di campionamento di Nyquist-Shannon afferma che la frequenza di campionamento dovrebbe essere almeno il doppio della componente di frequenza più alta nel segnale per ricostruirlo correttamente. Nel contesto della classificazione del movimento e del rilevamento delle anomalie per il trasporto, la scelta della frequenza di campionamento dipenderebbe da diversi fattori:</p>
<ol type="1">
<li><p><strong>Natura del movimento</strong>: Diversi tipi di trasporto (terrestre, marittimo, ecc.) possono comportare diversi intervalli di frequenze di movimento. Movimenti più rapidi potrebbero richiedere frequenze di campionamento più elevate.</p></li>
<li><p><strong>Limitazioni hardware</strong>: La scheda Arduino Nicla Vision e tutti i sensori associati potrebbero avere limitazioni sulla velocità con cui possono campionare i dati.</p></li>
<li><p><strong>Risorse di Calcolo</strong>: Frequenze di campionamento più elevate genereranno più dati, il che potrebbe essere computazionalmente intensivo, particolarmente critico in un ambiente TinyML.</p></li>
<li><p><strong>Durata della Batteria</strong>: Una frequenza di campionamento più elevata consumerà più energia. Se il sistema funziona a batteria, questa è una considerazione importante.</p></li>
<li><p><strong>Archiviazione Dati</strong>: Un campionamento più frequente richiederà più spazio di archiviazione, un’altra considerazione cruciale per i sistemi embedded con memoria limitata.</p></li>
</ol>
<p>In molte attività di riconoscimento delle attività umane, vengono comunemente utilizzate <strong>frequenze di campionamento da 50 Hz a 100 Hz circa</strong>. Dato che stiamo simulando scenari di trasporto, che in genere non sono eventi ad alta frequenza, una frequenza di campionamento in quell’intervallo (50-100 Hz) potrebbe essere un punto di partenza ragionevole.</p>
<p>Definiamo uno sketch che ci consentirà di acquisire i nostri dati con una frequenza di campionamento definita (ad esempio, 50 Hz):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Based on Edge Impulse Data Forwarder Example (Arduino)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">  - https://docs.edgeimpulse.com/docs/cli-data-forwarder</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * Developed by M.Rovai @11May23</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">/* Include ----------------------------------------------------------------- */</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Arduino_LSM6DSOX.h&gt;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">/* Constant defines -------------------------------------------------------- */</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CONVERT_G_TO_MS2 </span><span class="fl">9.80665</span><span class="bu">f</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#define FREQUENCY_HZ        </span><span class="dv">50</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="pp">#define INTERVAL_MS         </span><span class="op">(</span><span class="dv">1000</span><span class="pp"> </span><span class="op">/</span><span class="pp"> </span><span class="op">(</span>FREQUENCY_HZ<span class="pp"> </span><span class="op">+</span><span class="pp"> </span><span class="dv">1</span><span class="op">))</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">static</span> <span class="dt">unsigned</span> <span class="dt">long</span> last_interval_ms <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span> x<span class="op">,</span> y<span class="op">,</span> z<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  Serial<span class="op">.</span>begin<span class="op">(</span><span class="dv">9600</span><span class="op">);</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(!</span>Serial<span class="op">);</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(!</span>IMU<span class="op">.</span>begin<span class="op">())</span> <span class="op">{</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    Serial<span class="op">.</span>println<span class="op">(</span><span class="st">"Failed to initialize IMU!"</span><span class="op">);</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>millis<span class="op">()</span> <span class="op">&gt;</span> last_interval_ms <span class="op">+</span> INTERVAL_MS<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    last_interval_ms <span class="op">=</span> millis<span class="op">();</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>IMU<span class="op">.</span>accelerationAvailable<span class="op">())</span> <span class="op">{</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Read raw acceleration measurements from the device</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      IMU<span class="op">.</span>readAcceleration<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> z<span class="op">);</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      <span class="co">// converting to m/s2</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>      <span class="dt">float</span> ax_m_s2 <span class="op">=</span> x <span class="op">*</span> CONVERT_G_TO_MS2<span class="op">;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>      <span class="dt">float</span> ay_m_s2 <span class="op">=</span> y <span class="op">*</span> CONVERT_G_TO_MS2<span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      <span class="dt">float</span> az_m_s2 <span class="op">=</span> z <span class="op">*</span> CONVERT_G_TO_MS2<span class="op">;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      Serial<span class="op">.</span>print<span class="op">(</span>ax_m_s2<span class="op">);</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      Serial<span class="op">.</span>print<span class="op">(</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>      Serial<span class="op">.</span>print<span class="op">(</span>ay_m_s2<span class="op">);</span> </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>      Serial<span class="op">.</span>print<span class="op">(</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      Serial<span class="op">.</span>println<span class="op">(</span>az_m_s2<span class="op">);</span> </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Caricando lo sketch e ispezionando il Serial Monitor, possiamo vedere che stiamo catturando 50 campioni al secondo.</p>
<p><img src="images/jpg/sampling.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>Si noti che con la scheda Nicla appoggiata su un tavolo (con la telecamera rivolta verso il basso), l’asse z misura circa 9.8m/s<span class="math inline">\(^2\)</span>, l’accelerazione terrestre prevista.</p>
</blockquote>
</section>
</section>
<section id="il-caso-di-studio-trasporto-simulato-di-container" class="level2">
<h2 class="anchored" data-anchor-id="il-caso-di-studio-trasporto-simulato-di-container">Il Caso di Studio: Trasporto Simulato di Container</h2>
<p>Simuleremo il trasporto di container (o meglio di pacchi) attraverso diversi scenari per rendere questo tutorial più comprensibile e pratico. Utilizzando l’accelerometro integrato della scheda Arduino Nicla Vision, cattureremo i dati di movimento simulando manualmente le condizioni di:</p>
<ol type="1">
<li>Trasporto <strong>Terrestre</strong> (su strada o treno)</li>
<li>Trasporto <strong>Marittimo</strong></li>
<li>Movimento Verticale tramite Carrello <strong>Elevatore</strong></li>
<li>Periodo di <strong>stazionamento</strong> (inattivo) in un Magazzino</li>
</ol>
<p><img src="images/jpg/classes.jpg" class="img-fluid"></p>
<p>Dalle immagini sopra, possiamo definire per la nostra simulazione che i movimenti principalmente orizzontali (asse x o y) dovrebbero essere associati alla “classe Terrestre”, i movimenti verticali (asse z) alla “classe di Sollevamento”, nessuna attività alla “classe di Inattività” e il movimento su tutti e tre gli assi alla <a href="https://www.containerhandbuch.de/chb_e/stra/index.html?/chb_e/stra/stra_02_03_03.htm">classe Marittima</a>.</p>
<p><img src="images/jpg/classes_mov_def.jpg" class="img-fluid"></p>
</section>
<section id="raccolta-dati" class="level2">
<h2 class="anchored" data-anchor-id="raccolta-dati">Raccolta Dati</h2>
<p>Per la raccolta dati, possiamo avere diverse opzioni. In un caso reale, possiamo avere il nostro dispositivo, ad esempio, collegato direttamente a un contenitore e i dati raccolti su un file (ad esempio .CSV) e archiviati su una scheda SD (tramite connessione SPI) o un repository offline nel computer. I dati possono anche essere inviati in remoto a un repository nelle vicinanze, come un telefono cellulare, tramite Bluetooth (come fatto in questo progetto: <a href="https://www.hackster.io/mjrobot/sensor-datalogger-50e44d">Sensor DataLogger</a>). Una volta che il dataset è stato raccolto e archiviato come file .CSV, può essere caricato su Studio utilizzando lo <a href="https://docs.edgeimpulse.com/docs/edge-impulse-studio/data-acquisition/csv-wizard">strumento CSV Wizard</a>.</p>
<blockquote class="blockquote">
<p>In questo <a href="https://youtu.be/2KBPq_826WM">video</a>, si possono imparare modi alternativi per inviare dati a Edge Impulse Studio.</p>
</blockquote>
<section id="collegamento-del-dispositivo-a-edge-impulse" class="level3">
<h3 class="anchored" data-anchor-id="collegamento-del-dispositivo-a-edge-impulse">Collegamento del dispositivo a Edge Impulse</h3>
<p>Collegheremo Nicla direttamente a Edge Impulse Studio, che verrà utilizzato anche per la pre-elaborazione dei dati, l’addestramento del modello, i test e la distribuzione. Per questo, ci sono due possibilità:</p>
<ol type="1">
<li>Scaricare il firmware più recente e collegarlo direttamente alla sezione <code>Raccolta Dati</code>.</li>
<li>Utilizzare il tool <a href="https://docs.edgeimpulse.com/docs/edge-impulse-cli/cli-data-forwarder">CLI Data Forwarder</a> per acquisire i dati dal sensore e inviarli a Studio.</li>
</ol>
<p>L’opzione 1 è più semplice, come abbiamo visto nell’esercitazione <em>Configurazione di Nicla Vision</em>, ma l’opzione 2 darà maggiore flessibilità per quanto riguarda l’acquisizione dei dati, come la definizione della frequenza di campionamento. Facciamolo con l’ultima.</p>
<p>Creare un nuovo progetto su Edge Impulse Studio (EIS) e collegarvi Nicla, seguendo questi passaggi:</p>
<ol type="1">
<li>Installare <a href="https://docs.edgeimpulse.com/docs/edge-impulse-cli/cli-installation">Edge Impulse CLI</a> e <a href="https://nodejs.org/en/">Node.js</a> sul computer.</li>
<li>Caricare uno sketch per l’acquisizione dati (quello discusso in precedenza in questo tutorial).</li>
<li>Utilizzare <a href="https://docs.edgeimpulse.com/docs/edge-impulse-cli/cli-data-forwarder">CLI Data Forwarder</a> per acquisire dati dall’accelerometro di Nicla e inviarli a Studio, come mostrato in questo diagramma:</li>
</ol>
<p><img src="images/jpg/data-forw.jpg" class="img-fluid"></p>
<p>Avviare <a href="https://docs.edgeimpulse.com/docs/edge-impulse-cli/cli-data-forwarder">CLI Data Forwarder</a> sul terminale, immettendo (se è la prima volta) il seguente comando:</p>
<pre><code>$ edge-impulse-data-forwarder --clean</code></pre>
<p>Quindi, immettere le proprie credenziali EI e scegliere il progetto, le variabili (ad esempio, <em>accX,</em> <em>accY</em> e <em>accZ</em>) e il nome del dispositivo (ad esempio, <em>NiclaV</em>):</p>
<p><img src="images/jpg/term.jpg" class="img-fluid"></p>
<p>Andare alla sezione <code>Devices</code> sul progetto EI e verificare se il dispositivo è connesso (il punto dovrebbe essere verde):</p>
<p><img src="images/jpg/device.jpg" class="img-fluid"></p>
<blockquote class="blockquote">
<p>Si può clonare il progetto sviluppato per questa esercitazione pratica: <a href="https://studio.edgeimpulse.com/public/302078/latest">NICLA Vision Movement Classification</a>.</p>
</blockquote>
</section>
<section id="raccolta-dati-1" class="level3">
<h3 class="anchored" data-anchor-id="raccolta-dati-1">Raccolta Dati</h3>
<p>Nella sezione <code>Data Acquisition</code>, si dovrebbe vedere che la scheda <code>[NiclaV]</code> è connessa. Il sensore è disponibile: <code>[sensor with 3 axes (accX, accY, accZ)]</code> con una frequenza di campionamento di <code>[50Hz]</code>. Studio suggerisce una lunghezza di campionamento di <code>[10000]</code> ms (10s). L’ultima cosa rimasta è definire l’etichetta del campione. Cominciamo con <code>[terrestrial]</code>:</p>
<p><img src="images/jpg/collect_data.jpg" class="img-fluid"></p>
<p><strong>Terrestrial</strong> (pallet in un Camion o Treno), muovendosi orizzontalmente. Premere <code>[Start Sample]</code> e spostare il device orizzontalmente, mantenendo una direzione sopra il tavolo. Dopo 10s, i dati saranno caricati nello Studio. Ecco come è stato raccolto il campione:</p>
<p><img src="images/jpg/terrestrial_result.jpg" class="img-fluid"></p>
<p>Come previsto, il movimento è stato catturato principalmente nell’asse Y (verde). Nel blu, vediamo l’asse Z, circa -10 m/s<span class="math inline">\(^2\)</span> (Nicla ha la telecamera rivolta verso l’alto).</p>
<p>Come discusso in precedenza, dovremmo catturare dati da tutte e quattro le classi Transportation”. Quindi, si immagini di avere un container con un accelerometro integrato nelle seguenti situazioni:</p>
<p><strong>Maritime</strong> (pallet in barche in un oceano in tempesta). Il movimento viene catturato su tutti e tre gli assi:</p>
<p><img src="images/jpg/maritime_result.jpg" class="img-fluid"></p>
<p><strong>Lift</strong> (Pallet movimentati verticalmente da un Carrello elevatore). Movimento catturato solo sull’asse Z:</p>
<p><img src="images/jpg/lift_result.jpg" class="img-fluid"></p>
<p><strong>Idle</strong> (Pallet in un magazzino). Nessun movimento rilevato dall’accelerometro:</p>
<p><img src="images/jpg/idle_result.jpg" class="img-fluid"></p>
<p>Ad esempio, si possono catturare 2 minuti (dodici campioni di 10 secondi) per ciascuna delle quattro classi (per un totale di 8 minuti di dati). Utilizzando il menù <code>tre puntini</code> dopo ciascuno dei campioni, selezionarne 2, riservandoli per il set di Test. In alternativa, si può utilizzare lo strumento automatico <code>Train/Test Split tool</code> nella scheda <code>Danger Zone</code> della scheda <code>Dashboard</code>. Di seguito il set di dati risultante:</p>
<p><img src="images/jpg/dataset.jpg" class="img-fluid"></p>
<p>Una volta acquisito il dataset, lo si può esplorare più in dettaglio utilizzando <a href="https://docs.edgeimpulse.com/docs/edge-impulse-studio/data-acquisition/data-explorer">Data Explorer</a>, uno strumento visivo per trovare valori anomali o dati etichettati in modo errato (aiutando a correggerli). Data Explorer tenta prima di estrarre feature significative dai dati (applicando l’elaborazione del segnale e gli “embedding” della rete neurale) e poi utilizza un algoritmo di riduzione della dimensionalità come <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> o <a href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding">t-SNE</a> per mappare queste feature in uno spazio 2D. Questo fornisce una panoramica immediata del dataset completo.</p>
<p><img src="images/jpg/data_explorer.jpg" class="img-fluid"></p>
<p>Nel nostro caso, il set di dati sembra OK (buona separazione). Ma il PCA mostra che possiamo avere problemi tra marittimo (verde) e sollevamento (arancione). Ciò è prevedibile, una volta su una barca, a volte il movimento può essere solo “verticale”.</p>
</section>
</section>
<section id="impulse-design" class="level2">
<h2 class="anchored" data-anchor-id="impulse-design">Impulse Design</h2>
<p>Il passo successivo è la definizione del nostro Impulse, che prende i dati grezzi e usa l’elaborazione del segnale per estrarre le feature, passandole come tensore di input di un <em>learning block</em> [blocco di apprendimento] per classificare nuovi dati. Si va in <code>Impulse Design</code> e <code>Create Impulse</code>. Studio suggerirà la progettazione di base. Aggiungiamo anche un secondo <em>Learning Block</em> per <code>Anomaly Detection</code>.</p>
<p><img src="images/jpg/impulse.jpg" class="img-fluid"></p>
<p>Questo secondo modello usa un modello K-means. Se immaginiamo di poter avere le nostre classi note come cluster, qualsiasi campione che si adatterebbe potrebbe essere un “outlier”, un’anomalia come un container che rotola fuori da una nave in mare o cade da un carrello elevatore.</p>
<p><img src="images/jpg/anomaly_detect.jpg" class="img-fluid"></p>
<p>La frequenza di campionamento dovrebbe essere catturata automaticamente, in caso contrario, inserirla: <code>[50]</code>Hz. Studio suggerisce una <em>Window Size</em> di 2 secondi (<code>[2000]</code> ms) con una <em>sliding window</em> di <code>[20]</code>ms. Ciò che stiamo definendo in questa fase è che pre-elaboreremo i dati catturati (dati di serie temporali), creando un dataset tabellare (caratteristiche) che saranno l’input per un classificatore di reti neurali (DNN) e un modello di rilevamento delle anomalie (K-Means), come mostrato di seguito:</p>
<p><img src="images/jpg/impulse-block.jpg" class="img-fluid"></p>
<p>Analizziamo attentamente quei passaggi e i parametri per capire meglio cosa stiamo facendo qui.</p>
<section id="panoramica-sulla-pre-elaborazione-dei-dati" class="level3">
<h3 class="anchored" data-anchor-id="panoramica-sulla-pre-elaborazione-dei-dati">Panoramica sulla Pre-Elaborazione dei Dati</h3>
<p>La pre-elaborazione dei dati consiste nell’estrapolare le feature dal set di dati acquisito con l’accelerometro, il che implica l’elaborazione e l’analisi dei dati grezzi. Gli accelerometri misurano l’accelerazione di un oggetto lungo uno o più assi (in genere tre, indicati come X, Y e Z). Queste misure possono essere utilizzate per comprendere vari aspetti del movimento dell’oggetto, come pattern di movimento e vibrazioni.</p>
<p>I dati grezzi dell’accelerometro possono essere rumorosi e contenere errori o informazioni irrilevanti. Le fasi di pre-elaborazione, come il filtraggio e la normalizzazione, possono pulire e standardizzare i dati, rendendoli più adatti all’estrazione di feature. Nel nostro caso, dovremmo dividere i dati in segmenti più piccoli o <strong>windows</strong> [finestre]. Ciò può aiutare a concentrarsi su eventi o attività specifici all’interno del dataset, rendendo l’estrazione di feature più gestibile e significativa. La scelta della <strong>window size</strong> e della sovrapposizione (<strong>window increase</strong>) dipende dall’applicazione e dalla frequenza degli eventi di interesse. Come regola generale, dovremmo provare a catturare un paio di “cicli di dati”.</p>
<blockquote class="blockquote">
<p>Con un “sampling rate” (SR) [frequenza di campionamento] di 50 Hz e una dimensione della finestra di 2 secondi, otterremo 100 campioni per asse, o 300 in totale (3 assi x 2 secondi x 50 campioni). Faremo scorrere questa finestra ogni 200 ms, creando un set di dati più grande in cui ogni istanza ha 300 feature grezze.</p>
</blockquote>
<p><img src="images/jpg/pre-process.jpg" class="img-fluid"></p>
<p>Una volta che i dati sono stati pre-elaborati e segmentati, si possono estrarre feature che descrivono le caratteristiche del movimento. Alcune feature tipiche estratte dai dati dell’accelerometro includono:</p>
<ul>
<li>Le feature del <strong>Time-domain</strong> descrivono le proprietà statistiche dei dati all’interno di ciascun segmento, come media, mediana, deviazione standard, asimmetria, curtosi e tasso di attraversamento dello zero.</li>
<li>Le feature <strong>Frequency-domain</strong> si ottengono trasformando i dati nel dominio della frequenza utilizzando tecniche come la Fast Fourier Transform (FFT). Alcune feature tipiche del dominio della frequenza includono lo spettro di potenza, l’energia spettrale, le frequenze dominanti (ampiezza e frequenza) e l’entropia spettrale.</li>
<li>Le feature del dominio <strong>Time-frequency</strong> combinano le informazioni del dominio del tempo e della frequenza, come la Short-Time Fourier Transform (STFT) o la Discrete Wavelet Transform (DWT). Possono fornire una comprensione più dettagliata di come il contenuto di frequenza del segnale cambia nel tempo.</li>
</ul>
<p>In molti casi, il numero di feature estratte può essere elevato, il che può portare a un overfitting o a una maggiore complessità computazionale. Le tecniche di selezione delle feature, come le informazioni reciproche, i metodi basati sulla correlazione o l’analisi delle componenti principali (PCA), possono aiutare a identificare le feature più rilevanti per una determinata applicazione e ridurre la dimensionalità del dataset. Studio può aiutare con tali calcoli di importanza delle feature.</p>
</section>
<section id="feature-spettrali-di-ei-studio" class="level3">
<h3 class="anchored" data-anchor-id="feature-spettrali-di-ei-studio">Feature Spettrali di EI Studio</h3>
<p>La pre-elaborazione dei dati è un’area impegnativa per il machine learning embedded; tuttavia, Edge Impulse aiuta a superarla con la sua fase di pre-elaborazione del segnale digitale (DSP) e, più specificamente, con lo <a href="https://docs.edgeimpulse.com/docs/edge-impulse-studio/processing-blocks/spectral-features">Spectral Features Block</a>.</p>
<p>In Studio, il dataset grezzo raccolto sarà l’input di un blocco di Spectral Analysis, che è eccellente per analizzare il movimento ripetitivo, come i dati degli accelerometri. Questo blocco eseguirà un DSP (Digital Signal Processing), estraendo feature come la <a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">FFT</a> o le <a href="https://en.wikipedia.org/wiki/Digital_signal_processing#Wavelet">Wavelet</a>.</p>
<p>Per il nostro progetto, una volta che il segnale temporale è continuo, dovremmo usare FFT con, ad esempio, una lunghezza di <code>[32]</code>.</p>
<p>Le feature <strong>Time Domain Statistical</strong> per asse/canale sono:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Root_mean_square">RMS</a>: 1 feature</li>
<li><a href="https://colab.research.google.com/corgiredirector?site=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSkewness">Skewness</a> [Asimmetria]: 1 feature</li>
<li><a href="https://colab.research.google.com/corgiredirector?site=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FKurtosis">Curtosi</a>: 1 feature</li>
</ul>
<p>Le feature <strong>Frequency Domain Spectral features</strong> per asse/canale sono:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Spectral_density">Potenza Spettrale</a>: 16 feature (lunghezza FFT/2)</li>
<li>Asimmetria: 1 feature</li>
<li>Curtosi: 1 feature</li>
</ul>
<p>Quindi, per una lunghezza FFT di 32 punti, l’output risultante dello “Spectral Analysis Block” sarà di 21 feature per asse (un totale di 63 feature).</p>
<blockquote class="blockquote">
<p>Si può scoprire di più su come viene calcolata ogni feature scaricando il notebook <a href="https://github.com/Mjrovai/Arduino_Nicla_Vision/blob/main/Motion_Classification/Edge_Impulse_Spectral_Features_Block.ipynb">Edge Impulse - Spectral Features Block Analysis</a> <a href="https://www.hackster.io/mjrobot/tinyml-under-the-hood-spectral-analysis-94676c">TinyML under the hood: Spectral Analysis</a> o <a href="https://colab.research.google.com/github/Mjrovai/Arduino_Nicla_Vision/blob/main/Motion_Classification/Edge_Impulse_Spectral_Features_Block.ipynb">aprendolo direttamente su Google CoLab</a>.</p>
</blockquote>
</section>
<section id="generazione-di-feature" class="level3">
<h3 class="anchored" data-anchor-id="generazione-di-feature">Generazione di feature</h3>
<p>Una volta capito cosa fa la pre-elaborazione, è il momento di finire il lavoro. Quindi, prendiamo i dati grezzi (tipo serie temporale) e convertiamoli in dati tabellari. Per farlo, si va alla sezione <code>Spectral Features</code> nella scheda <code>Parameters</code>, si definiscono i parametri principali come discusso nella sezione precedente (<code>[FFT]</code> con <code>[32]</code> punti), e si seleziona <code>[Save Parameters]</code>:</p>
<p><img src="images/jpg/Parameters_definition.jpg" class="img-fluid"></p>
<p>Nel menù in alto, si seleziona l’opzione <code>Generate Features</code> e il pulsante <code>Generate Features</code>. Ogni dato della finestra di 2 secondi verrà convertito in un punto dati di 63 feature.</p>
<blockquote class="blockquote">
<p>Feature Explorer mostrerà tali dati in 2D utilizzando <a href="https://umap-learn.readthedocs.io/en/latest/">UMAP.</a> Uniform Manifold Approximation and Projection (UMAP) è una tecnica di riduzione delle dimensioni che può essere utilizzata per la visualizzazione in modo simile a t-SNE, ma è applicabile anche per la riduzione generale delle dimensioni non lineari.</p>
</blockquote>
<p>La visualizzazione consente di verificare che dopo la generazione delle feature, le classi presenti mantengano la loro eccellente separazione, il che indica che il classificatore dovrebbe funzionare bene. Facoltativamente, si può analizzare quanto è importante ciascuna delle feature per una classe rispetto alle altre.</p>
<p><img src="images/jpg/feature_generation.jpg" class="img-fluid"></p>
</section>
</section>
<section id="addestramento-dei-modelli" class="level2">
<h2 class="anchored" data-anchor-id="addestramento-dei-modelli">Addestramento dei Modelli</h2>
<p>Il nostro classificatore sarà una Dense Neural Network (DNN) che avrà 63 neuroni sul suo layer di input, due layer nascosti con 20 e 10 neuroni e un layer di output con quattro neuroni (uno per ogni classe), come mostrato qui:</p>
<p><img src="images/jpg/model.jpg" class="img-fluid"></p>
<p>Come iperparametri, useremo un Learning Rate di <code>[0.005]</code>, una dimensione Batch di <code>[32]</code> e <code>[20]</code>% di dati per la convalida per <code>[30]</code> epoche. Dopo l’addestramento, possiamo vedere che l’accuratezza è del 98.5%. Il costo della memoria e della latenza è esiguo.</p>
<p><img src="images/jpg/train.jpg" class="img-fluid"></p>
<p>Per la “Anomaly Detection”, sceglieremo le feature suggerite che sono esattamente le più importanti nell’estrazione delle feature, più l’RMS accZ. Il numero di cluster sarà <code>[32]</code>, come suggerito da Studio:</p>
<p><img src="images/jpg/anom_det_train.jpg" class="img-fluid"></p>
</section>
<section id="test" class="level2">
<h2 class="anchored" data-anchor-id="test">Test</h2>
<p>Possiamo verificare come si comporterà il nostro modello con dati sconosciuti utilizzando il 20% dei dati lasciati da parte durante la fase di acquisizione dei dati. Il risultato è stato quasi del 95%, il che è positivo. Si può sempre lavorare per migliorare i risultati, ad esempio, per capire cosa è andato storto con uno dei risultati sbagliati. Se si tratta di una situazione unica, la si può aggiungere al set di dati di training e quindi ripeterla.</p>
<p>La soglia minima di default per un risultato considerato incerto è <code>[0.6]</code> per la classificazione e <code>[0.3]</code> per l’anomalia. Una volta che abbiamo quattro classi (la loro somma di output dovrebbe essere 1.0), si può anche impostare una soglia inferiore per una classe da considerare valida (ad esempio, 0.4). Si possono <code>Impostare le soglie di confidenza</code> nel menù <code>tre puntini</code>, oltre al pulsante <code>Classify all</code>.</p>
<p><img src="images/jpg/model_testing.jpg" class="img-fluid"></p>
<p>Puoi anche eseguire “Live Classification” col dispositivo (che dovrebbe essere ancora connesso a Studio).</p>
<blockquote class="blockquote">
<p>Da tenere presente che qui, si cattureranno dati reali col dispositivo e si caricheranno in Studio, dove verrà presa un’inferenza utilizzando il modello addestrato (ma il <strong>modello NON è nel device</strong>).</p>
</blockquote>
</section>
<section id="distribuzione" class="level2">
<h2 class="anchored" data-anchor-id="distribuzione">Distribuzione</h2>
<p>È il momento di distribuire il blocco di pre-elaborazione e il modello addestrato al Nicla. Studio impacchetterà tutte le librerie necessarie, le funzioni di pre-elaborazione e i modelli addestrati, scaricandoli sul computer. Si deve selezionare l’opzione <code>Arduino Library</code>, e in basso si può scegliere <code>Quantized (Int8)</code> o <code>Unoptimized (float32)</code> e <code>[Build]</code>. Verrà creato un file Zip e scaricato sul computer.</p>
<p><img src="images/jpg/deploy.jpg" class="img-fluid"></p>
<p>Su Arduino IDE, si va alla scheda <code>Sketch</code>, si seleziona <code>Add.ZIP Library</code> e si sceglie il file .zip scaricato da Studio. Un messaggio apparirà nel terminale IDE: <code>Library installed</code>.</p>
<section id="inferenza" class="level3">
<h3 class="anchored" data-anchor-id="inferenza">Inferenza</h3>
<p>Ora è il momento di un vero test. Faremo inferenze completamente scollegate da Studio. Modifichiamo uno degli esempi di codice creati quando si distribuisce la libreria Arduino.</p>
<p>Nell’IDE Arduino, si va alla scheda <code>File/Examples</code> e si cerca il progetto, e negli esempi, si seleziona <code>Nicla_vision_fusion</code>:</p>
<p><img src="images/jpg/inference.jpg" class="img-fluid"></p>
<p>Notare che il codice creato da Edge Impulse considera un approccio <em>sensor fusion</em> in cui vengono utilizzati IMU (accelerometro e giroscopio) e ToF. All’inizio del codice, ci sono le librerie relative al nostro progetto, IMU e ToF:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Includes ---------------------------------------------------------------- */</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;NICLA_Vision_Movement_Classification_inferencing.h&gt;</span><span class="pp"> </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Arduino_LSM6DSOX.h&gt;</span><span class="pp"> </span><span class="co">//IMU</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">"VL53L1X.h"</span><span class="pp"> </span><span class="co">// ToF</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>Si può mantenere il codice in questo modo per i test perché il modello addestrato utilizzerà solo le funzionalità pre-elaborate dall’accelerometro. Ma si consideri che si scriverà il codice solo con le librerie necessarie per un progetto reale.</p>
</blockquote>
<p>E questo è tutto!</p>
<p>Ora si può caricare il codice sul dispositivo e procedere con le inferenze. Si preme due volte il pulsante <code>[RESET]</code> di Nicla per metterlo in modalità boot (disconnetterlo da Studio se è ancora connesso) e caricare lo sketch sulla board.</p>
<p>Ora si devono provare diversi movimenti con la scheda (simili a quelli eseguiti durante l’acquisizione dei dati), osservando il risultato dell’inferenza di ciascuna classe sul Serial Monitor:</p>
<ul>
<li><strong>Classi Idle e lift:</strong></li>
</ul>
<p><img src="images/jpg/inference_1.jpg" class="img-fluid"></p>
<ul>
<li><strong>Maritime e terrestrial:</strong></li>
</ul>
<p><img src="images/jpg/inference_2.jpg" class="img-fluid"></p>
<p>Notare che in tutte le situazioni sopra, il valore di <code>anomaly score</code> era inferiore a 0.0. Provare un nuovo movimento che non faceva parte del dataset originale, ad esempio, “facendo rotolare” la Nicla, rivolta verso la telecamera capovolta, come un contenitore che cade da una barca o persino un incidente in barca:</p>
<ul>
<li><strong>Rilevamento delle Anomalie</strong></li>
</ul>
<p><img src="images/jpg/anomaly-boat.jpg" class="img-fluid"></p>
<p>In questo caso, l’anomalia è molto più grande, oltre 1.00</p>
</section>
<section id="post-elaborazione" class="level3">
<h3 class="anchored" data-anchor-id="post-elaborazione">Post-elaborazione</h3>
<p>Ora che sappiamo che il modello funziona poiché rileva i movimenti, suggeriamo di modificare il codice per vedere il risultato con il NiclaV completamente offline (scollegato dal PC e alimentato da una batteria, un power bank o un alimentatore indipendente da 5V).</p>
<p>L’idea è di fare lo stesso del progetto KWS: se viene rilevato un movimento specifico, potrebbe accendersi un LED specifico. Ad esempio, se viene rilevato un movimento <em>terrestre</em>, si accenderà il LED verde; se è un movimento <em>marittimo</em>, si accenderà il LED rosso, se è un <em>ascensore</em>, si accenderà il LED blu; e se non viene rilevato alcun movimento <em>(inattivo</em>), i LED saranno SPENTI. Si può anche aggiungere una condizione quando viene rilevata un’anomalia, in questo caso, ad esempio, può essere utilizzato un colore bianco (tutti i LED e si accendono contemporaneamente).</p>
</section>
</section>
<section id="conclusione" class="level2">
<h2 class="anchored" data-anchor-id="conclusione">Conclusione</h2>
<blockquote class="blockquote">
<p>I notebook e i codici utilizzati in questo tutorial pratico si trovano nel repository <a href="https://github.com/Mjrovai/Arduino_Nicla_Vision/tree/main/Motion_Classification">GitHub</a>.</p>
</blockquote>
<p>Prima di concludere, considerare che la classificazione del movimento e il rilevamento degli oggetti possono essere utilizzati in molte applicazioni in vari domini. Ecco alcune delle potenziali applicazioni:</p>
<section id="applicazioni-di-casi" class="level3">
<h3 class="anchored" data-anchor-id="applicazioni-di-casi">Applicazioni di Casi</h3>
<section id="industriale-e-manifatturiero" class="level4">
<h4 class="anchored" data-anchor-id="industriale-e-manifatturiero">Industriale e Manifatturiero</h4>
<ul>
<li><strong>Manutenzione Predittiva</strong>: Rilevamento di anomalie nel movimento dei macchinari per prevedere guasti prima che si verifichino.</li>
<li><strong>Controllo Qualità</strong>: Monitoraggio del movimento di linee di assemblaggio o bracci robotici per la valutazione della precisione e il rilevamento delle deviazioni dal pattern di movimenti standard.</li>
<li><strong>Logistica di Magazzino</strong>: Gestione e tracciamento del movimento delle merci con sistemi automatizzati che classificano diversi tipi di movimento e rilevano anomalie nella movimentazione.</li>
</ul>
</section>
<section id="assistenza-sanitaria" class="level4">
<h4 class="anchored" data-anchor-id="assistenza-sanitaria">Assistenza Sanitaria</h4>
<ul>
<li><strong>Monitoraggio Pazienti</strong>: Rilevamento di cadute o movimenti anomali negli anziani o in coloro che hanno problemi di mobilità.</li>
<li><strong>Riabilitazione</strong>: Monitoraggio dei progressi dei pazienti in fase di recupero da infortuni tramite classificazione dei pattern di movimento durante le sedute di fisioterapia.</li>
<li><strong>Riconoscimento Attività</strong>: Classificazione dei tipi di attività fisica per applicazioni di fitness o monitoraggio dei pazienti.</li>
</ul>
</section>
<section id="elettronica-di-consumo" class="level4">
<h4 class="anchored" data-anchor-id="elettronica-di-consumo">Elettronica di Consumo</h4>
<ul>
<li><strong>Gesture Control</strong>: Interpretazione di movimenti specifici per controllare i dispositivi, come accendere le luci con un gesto della mano.</li>
<li><strong>Gaming</strong>: Miglioramento delle esperienze di gioco con input controllati dal movimento.</li>
</ul>
</section>
<section id="trasporti-e-logistica" class="level4">
<h4 class="anchored" data-anchor-id="trasporti-e-logistica">Trasporti e Logistica</h4>
<ul>
<li><strong>Telematica dei Veicoli</strong>: Monitoraggio del movimento del veicolo per comportamenti insoliti come frenate brusche, curve strette o incidenti.</li>
<li><strong>Monitoraggio del Carico</strong>: Garantire l’integrità delle merci durante il trasporto rilevando movimenti insoliti che potrebbero indicare manomissioni o cattiva gestione.</li>
</ul>
</section>
<section id="città-intelligenti-e-infrastrutture" class="level4">
<h4 class="anchored" data-anchor-id="città-intelligenti-e-infrastrutture">Città Intelligenti e Infrastrutture</h4>
<ul>
<li><strong>Monitoraggio Strutturale</strong>: Rilevare vibrazioni o movimenti all’interno delle strutture che potrebbero indicare potenziali guasti o necessità di manutenzione.</li>
<li><strong>Gestione del Traffico</strong>: Analizzare il flusso di pedoni o veicoli per migliorare la mobilità e la sicurezza urbana.</li>
</ul>
</section>
<section id="sicurezza-e-sorveglianza" class="level4">
<h4 class="anchored" data-anchor-id="sicurezza-e-sorveglianza">Sicurezza e Sorveglianza</h4>
<ul>
<li><strong>Rilevamento Intrusi</strong>: Rilevare pattern di movimento tipici di accessi non autorizzati o altre violazioni della sicurezza.</li>
<li><strong>Monitoraggio della Fauna Selvatica</strong>: Rilevare bracconieri o movimenti anomali di animali in aree protette.</li>
</ul>
</section>
<section id="agricoltura" class="level4">
<h4 class="anchored" data-anchor-id="agricoltura">Agricoltura</h4>
<ul>
<li><strong>Monitoraggio delle Attrezzature</strong>: Monitoraggio delle prestazioni e dell’utilizzo di macchinari agricoli.</li>
<li><strong>Analisi del Comportamento Animale</strong>: Monitoraggio dei movimenti del bestiame per rilevare comportamenti che indicano problemi di salute o stress.</li>
</ul>
</section>
<section id="monitoraggio-ambientale" class="level4">
<h4 class="anchored" data-anchor-id="monitoraggio-ambientale">Monitoraggio Ambientale</h4>
<ul>
<li><strong>Attività Sismica</strong>: Rilevamento di pattern di movimento irregolari che precedono terremoti o altri eventi geologicamente rilevanti.</li>
<li><strong>Oceanografia</strong>: Studio di pattern di onde o movimenti marini per scopi di ricerca e sicurezza.</li>
</ul>
</section>
</section>
<section id="custodia-per-nicla-3d" class="level3">
<h3 class="anchored" data-anchor-id="custodia-per-nicla-3d">Custodia per Nicla 3D</h3>
<p>Per applicazioni reali, come alcuni hanno descritto in precedenza, possiamo aggiungere una custodia al nostro dispositivo ed Eoin Jordan, di Edge Impulse, ha sviluppato un’ottima custodia indossabile e per la salute delle macchine per la gamma di schede Nicla. Funziona con un magnete da 10 mm, viti da 2M e una cinghia da 16mm per scenari di utilizzo per la salute umana e delle macchine. Ecco il link: <a href="https://www.thingiverse.com/thing:5923305">Arduino Nicla Voice e Vision Wearable Case</a>.</p>
<p><img src="images/jpg/case.jpg" class="img-fluid"></p>
<p>Le applicazioni per la classificazione del movimento e il rilevamento delle anomalie sono estese e Arduino Nicla Vision è adatto per scenari in cui il basso consumo energetico e l’edge processing sono vantaggiosi. Il suo piccolo fattore di forma e l’efficienza nell’elaborazione lo rendono una scelta ideale per l’implementazione di applicazioni portatili e remote in cui l’elaborazione in tempo reale è fondamentale e la connettività potrebbe essere limitata.</p>
</section>
</section>
<section id="risorse" class="level2">
<h2 class="anchored" data-anchor-id="risorse">Risorse</h2>
<ul>
<li><p><a href="https://github.com/Mjrovai/Arduino_Nicla_Vision/tree/main/Motion_Classification/Niclav_Acc_Data_Capture">Codice Arduino</a></p></li>
<li><p><a href="https://colab.research.google.com/github/Mjrovai/Arduino_Nicla_Vision/blob/main/Motion_Classification/Edge_Impulse_Spectral_Features_Block.ipynb">Edge Impulse Spectral Features Block Colab Notebook</a></p></li>
<li><p><a href="https://studio.edgeimpulse.com/public/302078/latest">Progetto Edge Impulse</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
});
</script>
<script src="https://giscus.app/client.js" data-repo="harvard-edge/cs249r_book" data-repo-id="R_kgDOKQSOaw" data-category="General" data-category-id="DIC_kwDOKQSOa84CZ8Ry" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../../../contents/labs/arduino/nicla_vision/kws/kws.it.html" class="pagination-link" aria-label="Keyword Spotting (KWS)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Keyword Spotting (KWS)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../../../contents/labs/seeed/xiao_esp32s3/xiao_esp32s3.it.html" class="pagination-link" aria-label="XIAO ESP32S3">
        <span class="nav-page-text">XIAO ESP32S3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Scritto, modificato e curato dal Prof.&nbsp;Vijay Janapa Reddi (Harvard University)</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/harvard-edge/cs249r_book/edit/dev/contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.qmd" class="toc-action"><i class="bi bi-github"></i>Modifica questa pagina</a></li><li><a href="https://github.com/harvard-edge/cs249r_book/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li><li><a href="https://github.com/harvard-edge/cs249r_book/blob/dev/contents/labs/arduino/nicla_vision/motion_classification/motion_classification.it.qmd" class="toc-action"><i class="bi empty"></i>Mostra il codice</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Questo libro è stato creato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>