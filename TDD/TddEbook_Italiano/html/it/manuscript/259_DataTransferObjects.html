<!DOCTYPE html>

<html lang="it" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Oggetti di Trasferimento Dati &#8212; Documentazione TDD 2025 </title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=ad698211"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=45930005"></script>
    <link rel="index" title="Indice" href="../genindex.html" />
    <link rel="search" title="Cerca" href="../search.html" />
    <link rel="next" title="Parte 3: TDD nel Mondo Object-Oriented" href="260_Part3Marker.html" />
    <link rel="prev" title="Aspetti del design degli oggetti valore" href="257_Value%20objects_general_topics.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="data-transfer-objects">
<h1>Oggetti di Trasferimento Dati<a class="headerlink" href="#data-transfer-objects" title="Link to this heading">¶</a></h1>
<p>Osservando le strutture dati iniziali, Johnny e Benjamin le chiamarono Data Transfer Objects [<em>Oggetti di Trasferimento Dati</em>]</p>
<p>Un <em>Data Transfer Object</em> è un pattern per descrivere gli oggetti responsabili dello scambio di informazioni tra i confini del processo (TODO: confermare con il libro). Quindi, possiamo avere DTO che rappresentano l'input che il nostro processo riceve e DTO che rappresentano l'output che il nostro processo invia.</p>
<p>Come visto, i DTO sono in genere solo strutture dati. Ciò potrebbe sorprendere, perché ormai da diversi capitoli ho ripetutamente sottolineato come dovremmo unire dati e comportamenti. Non è questo infrangere tutte le regole che ho menzionato?</p>
<p>Sì, lo è e lo è per una buona ragione. Ma prima di spiegarlo, diamo un'occhiata a due modi di disaccoppiamento.</p>
</section>
<section id="decoupling-by-abstracting-behavior">
<h1>Disaccoppiamento mediante l'astrazione del comportamento<a class="headerlink" href="#decoupling-by-abstracting-behavior" title="Link to this heading">¶</a></h1>
<p>TODO: questo vale non solo per le interfacce ma anche per le funzioni</p>
<p>Questo è il modo di disaccoppiamento che ho descritto parlando della rete di oggetti. Diamo un'occhiata ad una semplice classe che rappresenta un documento che può essere stampato su una stampante:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Document</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">Add</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">additionalText</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_content</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">additionalText</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">PrintWith</span><span class="p">(</span><span class="n">PopularBrandPrinter</span><span class="w"> </span><span class="n">printer</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">_content</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notare che il metodo <code class="docutils literal notranslate"><span class="pre">PrintWith()</span></code> del documento richiede un'istanza di <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> che, per il bene di questo esempio, è una classe concreta che a sua volta dipende da una libreria specifica di un fornitore di terze parti (supponiamo che sia chiamato <code class="docutils literal notranslate"><span class="pre">ThirdPartyLib</span></code>). Ciò rende anche la nostra classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> indirettamente accoppiata a questa libreria. La direzione delle dipendenze è la seguente:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Document --&gt; PopularBrandPrinter --&gt; ThirdPartyLib
</pre></div>
</div>
<p>Perché tale dipendenza è un problema? Dopotutto, la classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> stessa non è a conoscenza direttamente della classe <code class="docutils literal notranslate"><span class="pre">ThirdPartyLib</span></code>? La risposta arriva quando pensiamo ai componenti. La direzione delle dipendenze così com'è ora dice: &quot;<code class="docutils literal notranslate"><span class="pre">Document</span></code> non funzionerà senza <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> che non funzionerà senza <code class="docutils literal notranslate"><span class="pre">ThirdPartyLib</span></code>&quot;. Quindi, se volessimo rilasciare una classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> in una libreria separata, ogni utente di questa libreria dovrebbe anche fare riferimento a <code class="docutils literal notranslate"><span class="pre">ThirdPartyLib</span></code>.</p>
<p>Possiamo risolvere questo problema utilizzando un'interfaccia. Tutto quello che dobbiamo fare è fare in modo che <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> implementi un'interfaccia (ad esempio chiamata <code class="docutils literal notranslate"><span class="pre">Printer</span></code>):</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">Printer</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">PopularBrandPrinter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Printer</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>E fare in modo che il nostro <code class="docutils literal notranslate"><span class="pre">Document</span></code> dipenda da quell'interfaccia invece che da <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code>:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Document</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">Add</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">additionalText</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_content</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">additionalText</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">PrintWith</span><span class="p">(</span><span class="n">Printer</span><span class="w"> </span><span class="n">printer</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">_content</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ciò modifica la direzione delle dipendenze in fase di compilazione<a class="footnote-reference brackets" href="#dip" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> nel modo seguente:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Document --&gt; Printer &lt;| -- PopularBrandPrinter --&gt; ThirdPartyLib
</pre></div>
</div>
<p>Da notare che questa volta il <code class="docutils literal notranslate"><span class="pre">Document</span></code> non dipende in alcun modo da <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code>. D'altra parte, la <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> dipende dall'interfaccia, perché deve implementarla.</p>
<p>Considerato ciò che abbiamo ottenuto finora, proviamo di nuovo a svolgere il nostro esercizio di partizionamento di questo codice in librerie. Questa volta possiamo farlo mettendo insieme <code class="docutils literal notranslate"><span class="pre">Document</span></code> con l'interfaccia <code class="docutils literal notranslate"><span class="pre">Printer</span></code> in una libreria e <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> in un'altra:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>|| Document --&gt; Printer || &lt;|-- PopularBrandPrinter --&gt; || ThirdPartyLib ||
</pre></div>
</div>
<p>Ora, la libreria che contiene <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> diventa una dipendenza opzionale - ogni utente di <code class="docutils literal notranslate"><span class="pre">Document</span></code> può decidere se utilizzare <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> o implementare l'interfaccia <code class="docutils literal notranslate"><span class="pre">Printer</span></code> in un altro modo. Altri fornitori possono anche rilasciare le proprie librerie che contengono le proprie implementazioni dell'interfaccia <code class="docutils literal notranslate"><span class="pre">Printer</span></code> tra le quali gli utenti della classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> possono poi scegliere.</p>
<p>Ciò è possibile perché abbiamo reso la classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> indipendente dai dettagli di implementazione di una particolare stampante e dipendente solo dalle firme astratte presenti nell'interfaccia. Pertanto, l'unica fonte di dipendenze aggiuntive per la classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> risulta dalle firme dei metodi dell'interfaccia (a proposito, possiamo esporre i dettagli di implementazione e le dipendenze indesiderate anche in questo modo, di cui ho scritto nei capitoli precedenti).</p>
</section>
<section id="decoupling-by-abstracting-data">
<h1>Disaccoppiamento mediante l'astrazione dei dati<a class="headerlink" href="#decoupling-by-abstracting-data" title="Link to this heading">¶</a></h1>
<p>Un altro modo per disaccoppiare il <code class="docutils literal notranslate"><span class="pre">Document</span></code> dai dettagli di implementazione di una particolare stampante è definire un formato di scambio dati intermedio.</p>
<p>Prendiamo l'esempio del documento e della stampante e capovolgiamo la situazione. Diciamo che ora la classe <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> dipende dal <code class="docutils literal notranslate"><span class="pre">Document</span></code>:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">PopularBrandPrinter</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="n">ThirdPartyPrintingDriver</span><span class="w"> </span><span class="n">_driver</span><span class="w"> </span>
<span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ThirdPartyPrintingDriver</span><span class="p">();</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">(</span><span class="n">Document</span><span class="w"> </span><span class="n">document</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_driver</span><span class="p">.</span><span class="n">Send</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>e la classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> è definita come:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Document</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">Add</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">additionalText</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_content</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">additionalText</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">GetContent</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_content</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>//TODO</p>
<p>La direzione delle dipendenze è così:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>PopularBrandPrinter --&gt; Document
                    --&gt; ThirdPartyLibrary
</pre></div>
</div>
<p>Ciò che vorremmo è impacchettare <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> in una libreria separata. Per fare ciò, dobbiamo renderlo indipendente da <code class="docutils literal notranslate"><span class="pre">Document</span></code>. Inoltre vorremmo che Document rimanesse indipendente dalla stampante. Cosa possiamo fare? Possiamo fare in modo che la stampante accetti non un documento, ma una stringa, che è un tipo di dati. Quindi il metodo <code class="docutils literal notranslate"><span class="pre">Print()</span></code> di <code class="docutils literal notranslate"><span class="pre">Printer</span></code> dovrebbe cambiare da:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">(</span><span class="n">Document</span><span class="w"> </span><span class="n">document</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_driver</span><span class="p">.</span><span class="n">Send</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>in:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">content</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_driver</span><span class="p">.</span><span class="n">Send</span><span class="p">(</span><span class="n">content</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>e il codice che utilizza la stampante non sarebbe più simile a questo:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//... get the document</span>
<span class="kt">var</span><span class="w"> </span><span class="n">printer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//... get the printer</span>
<span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">document</span><span class="p">);</span>
</pre></div>
</div>
<p>ma piuttosto:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//... get the document</span>
<span class="kt">var</span><span class="w"> </span><span class="n">printer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//... get the printer</span>
<span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">());</span>
</pre></div>
</div>
<p>Ora abbiamo una situazione in cui la classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> è disaccoppiata da <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> (ha solo un metodo che restituisce il suo contenuto come stringa) e anche <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> è disaccoppiata da <code class="docutils literal notranslate"><span class="pre">Document</span></code> (ha solo un metodo che accetta una <code class="docutils literal notranslate"><span class="pre">string</span></code>). Utilizzando una <code class="docutils literal notranslate"><span class="pre">string</span></code> come formato di scambio dati intermedio, abbiamo disaccoppiato le due classi l'una dall'altra.</p>
<p>Notare che questa tecnica non riguarda l'uso di stringhe. Il disaccoppiamento può essere effettuato utilizzando la nostra struttura dati personalizzata. Il punto è che i dati non incapsulano alcun comportamento (neppure le loro definizioni), quindi non siamo accoppiati ad essi. Quindi, ad esempio, quando il <code class="docutils literal notranslate"><span class="pre">Document</span></code>, invece di aggregare il testo che gli è stato passato, inizia a leggere il contenuto dal database e la sua firma <code class="docutils literal notranslate"><span class="pre">GetContent()</span></code> cambia in un metodo asincrono:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//... get the document</span>
<span class="kt">var</span><span class="w"> </span><span class="n">printer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">//... get the printer</span>
<span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">());</span>
</pre></div>
</div>
<p>Non è necessario modificare la stampante poiché è accoppiata all'astrazione dei dati, non all'astrazione del comportamento.</p>
<p>Questo può sembrare un disaccoppiamento più forte e migliore rispetto all’utilizzo di un comportamento astratto, ma ha anche un prezzo:</p>
<section id="issues-with-data-oriented-decoupling">
<h2>Problemi con il disaccoppiamento orientato ai dati<a class="headerlink" href="#issues-with-data-oriented-decoupling" title="Link to this heading">¶</a></h2>
<p>Innanzitutto il codice che coordina lo scambio tra <code class="docutils literal notranslate"><span class="pre">Document</span></code> e <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> deve diventare più complesso. Come descritto in precedenza, quando una stampante è accoppiata a un documento, la riga di codice che dice alla stampante di stampare assomiglia a questa:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">document</span><span class="p">);</span>
</pre></div>
</div>
<p>mentre nel caso in cui la stampante accetti una stringa, il codice di coordinamento deve chiamare anche il metodo <code class="docutils literal notranslate"><span class="pre">GetContent()</span></code>.</p>
<p>L’altro motivo è che questo approccio incentrato sui dati limita anche la nostra capacità di utilizzare il polimorfismo. Per illustrare ciò, vorrei tornare all’esempio che abbiamo utilizzato parlando del disaccoppiamento mediante l’astrazione del comportamento. Lì avevamo la seguente riga responsabile della stampa:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">document</span><span class="p">.</span><span class="n">PrintWith</span><span class="p">(</span><span class="n">printer</span><span class="p">);</span>
</pre></div>
</div>
<p>Quando il documento è responsabile della decisione su come stampare, potrebbe decidere di non stamparlo affatto. Si immagini che la nostra classe <code class="docutils literal notranslate"><span class="pre">Document</span></code> implementi un'interfaccia come questa:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">Printable</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">(</span><span class="n">Printer</span><span class="w"> </span><span class="n">printer</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Quindi potremmo avere un'altra classe che implementa questa interfaccia, ad es. chiamato <code class="docutils literal notranslate"><span class="pre">IgnoredPrintable</span></code> che avrebbe questa implementazione:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">IgnoredPrintable</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Printable</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">(</span><span class="n">Printer</span><span class="w"> </span><span class="n">printer</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//deliberately left empty</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Utilizzando questa classe, potremmo modificare il comportamento di questo codice:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">document</span><span class="p">.</span><span class="n">PrintWith</span><span class="p">(</span><span class="n">printer</span><span class="p">);</span>
</pre></div>
</div>
<p>senza doverlo cambiare.</p>
<p>Ora torniamo all'approccio incentrato sui dati:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">());</span>
</pre></div>
</div>
<p>Possiamo usare il polimorfismo in questo caso per ottenere lo stesso risultato? Bene, proviamo. Ancora una volta, immaginiamo di avere un'interfaccia chiamata <code class="docutils literal notranslate"><span class="pre">Printable</span></code>, ma questa volta è strutturata in questo modo:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">Printable</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nf">GetContent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ancora una volta, vogliamo creare un'implementazione che non stampi nulla, ma poi ci imbattiamo in un problema:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">IgnoredPrintable</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Printable</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">GetContent</span><span class="p">()</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">????</span><span class="p">;</span><span class="w"> </span><span class="c1">//!!!</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notare che quando implementiamo <code class="docutils literal notranslate"><span class="pre">GetContent()</span></code>, dobbiamo restituire <em>qualcosa</em>. Questo perché in questo caso le implementazioni di <code class="docutils literal notranslate"><span class="pre">Printable</span></code> non prendono la decisione se stampare o meno. Questa decisione deve essere presa dal codice che coordina la logica della stampa:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">());</span>
</pre></div>
</div>
<p>Può, ad es. controllare se è null:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">GetContent</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">printer</span><span class="p">.</span><span class="n">Print</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>ma il punto è che non possiamo sfruttare il polimorfismo dei documenti per nascondere questa decisione.</p>
<p>Questo perché, disaccoppiando i documenti dal comportamento di stampa, abbiamo perso la capacità di nascondere l'implementazione di quel comportamento. Perdendo la capacità di nascondere l’implementazione, abbiamo perso anche la capacità di nascondere la variabilità del comportamento. Pertanto, questa variabilità deve andare altrove. Ciò può portare all’aggregazione di molta complessità nei luoghi che coordinano la logica del caso d’uso.</p>
<ol class="arabic simple">
<li><p>più lavoro per i coordinatori - TODO un esempio con un if</p></li>
<li><p>nessun polimorfismo</p></li>
<li><p>immaginare che la corda fosse mutabile</p></li>
</ol>
</section>
</section>
<section id="use-both">
<h1>Usare entrambi<a class="headerlink" href="#use-both" title="Link to this heading">¶</a></h1>
<p>In realtà, mostrando due esempi ed etichettando il primo come disaccoppiamento centrato sul comportamento e l’altro come disaccoppiamento centrato sui dati, ho mentito un po’. Il primo esempio li conteneva entrambi. Da un lato, <code class="docutils literal notranslate"><span class="pre">Document</span></code> è stato disaccoppiato dall'implementazione della stampante reale tramite un'interfaccia astratta, dall'altro, <code class="docutils literal notranslate"><span class="pre">PopularBrandPrinter</span></code> è stato disaccoppiato dal documento perché accettava solo i suoi dati. Quindi la vera scelta è spesso tra la proporzione nell'utilizzo di ciascun tipo.</p>
</section>
<section id="dto-as-data-centric-decoupling-mechanism">
<h1>DTO come meccanismo di disaccoppiamento incentrato sui dati<a class="headerlink" href="#dto-as-data-centric-decoupling-mechanism" title="Link to this heading">¶</a></h1>
<p>Per il codice object-oriented, il disaccoppiamento incentrato sul comportamento è quello di default e più importante poiché senza una forte pressione su di esso, avremmo molte più difficoltà a sfruttare il polimorfismo.</p>
<p>D’altra parte, quando si scambiano informazioni tra i confini del processo, ci sono diversi motivi per cui preferiamo il disaccoppiamento incentrato sui dati:</p>
<ol class="arabic simple">
<li><p>le informazioni in genere vanno in formato binario o testuale.</p></li>
<li><p>Prestazione.</p></li>
<li><p>Contesti delimitati</p></li>
<li><p>Nessun pericolo di mutazione dei dati</p></li>
</ol>
<p>TODO: l'interfaccia è la definizione di comportamento</p>
<p>In un certo senso lo è ed è a causa del disaccoppiamento. Esistono due modi principali per disaccoppiare.</p>
<p>TODO: ogni sistema è procedurale ai confini.</p>
<p>DTO:</p>
<ol class="arabic simple">
<li><p>Due tipi di disaccoppiamento</p>
<ol class="arabic simple">
<li><p>con interfacce (descrizioni pure del comportamento, disaccoppiate dai dati)</p></li>
<li><p>con i dati (disaccoppia dal comportamento)</p></li>
</ol>
</li>
<li><p>Poiché è molto difficile trasmettere il comportamento e abbastanza facile trasmettere i dati, in genere i servizi scambiano dati, non comportamenti.</p></li>
<li><p>I DTO servono per lo scambio di dati tra processi</p></li>
<li><p>Rappresenta in genere un contratto dati esterno</p></li>
<li><p>I dati possono essere facilmente serializzati in testo o byte e deserializzati dall'altra parte.</p></li>
<li><p>I DTO possono contenere valori, sebbene ciò possa essere difficile perché questi valori devono essere serializzabili. Ciò potrebbe porre alcuni vincoli sui nostri tipi di valore a seconda del parser</p></li>
<li><p>differenze tra DTO e <em>oggetti valore</em> (gli <em>oggetti valore</em> possono avere un comportamento, i DTO no, sebbene la linea sia sfumata, ad esempio quando un <em>oggetto valore</em> fa parte di un DTO. String contiene molti comportamenti ma non sono specifici del dominio). Le DTO possono implementare l’uguaglianza?</p></li>
<li><p>Inoltre, per questo motivo, la logica applicativa dovrebbe essere tenuta lontana dai DTO per evitare di accoppiarli a contratti esterni e rendere difficile la serializzazione/deserializzazione.</p></li>
<li><p>Mappatura e Wrapping</p></li>
<li><p>Non ci sono mock dei DTO</p></li>
<li><p>i DTO di input sono di sola lettura e immutabili, ma possono avere i builder</p></li>
</ol>
</section>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="dip" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>ed è, in effetti, un esempio di utilizzo del <em>Dependency Inversion Principle</em>.</p>
</aside>
</aside>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">TDD</a></h1>








<h3>Navigazione</h3>
<p class="caption" role="heading"><span class="caption-text">Contenuti:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Cover.html">Titolo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Premessa</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="010_Dedication.html">Premessa</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_Dedication.html#dedications">Dediche</a></li>
<li class="toctree-l1"><a class="reference internal" href="015_Thanks.html">Grazie!</a></li>
<li class="toctree-l1"><a class="reference internal" href="017_CodeExamples.html">I codici di esempio</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parte 1:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="020_Part1Marker.html">Parte 1: Solo le nozioni di base</a></li>
<li class="toctree-l1"><a class="reference internal" href="030_Motivations.html">Motivazione: il primo passo per imparare il TDD</a></li>
<li class="toctree-l1"><a class="reference internal" href="040_Three_Essential_Tools.html"><span class="xref myst">Gli strumenti essenziali</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="050_Its_Not_a_Test.html">Non è (solo) un test</a></li>
<li class="toctree-l1"><a class="reference internal" href="060_Statement_First_Programming.html">La programmazione Statement-first</a></li>
<li class="toctree-l1"><a class="reference internal" href="070_Practicing_What_We_Already_Learned.html">Mettere in pratica ciò che abbiamo già imparato</a></li>
<li class="toctree-l1"><a class="reference internal" href="080_Sorting_out_the_bits.html">Facciamo un po' d'ordine</a></li>
<li class="toctree-l1"><a class="reference internal" href="090_How_to_start.html">Come iniziare?</a></li>
<li class="toctree-l1"><a class="reference internal" href="100_Analysis_In_TDD.html">In che modo il TDD riguarda l'analisi e cosa significa &quot;GIVEN-WHEN-THEN&quot;?</a></li>
<li class="toctree-l1"><a class="reference internal" href="110_What_is_the_scope_of_a_Statement_in_TDD.html">Qual è lo scopo di uno Statement a livello di unità in TDD?</a></li>
<li class="toctree-l1"><a class="reference internal" href="120_Constrained_Non_Determinism.html">Sviluppare uno stile TDD e Non-Determinismo Vincolato</a></li>
<li class="toctree-l1"><a class="reference internal" href="130_Boundaries.html">Specificare i confini e le condizioni funzionali</a></li>
<li class="toctree-l1"><a class="reference internal" href="140_Triangulation.html">Guidare l'implementazione dalle Specifiche</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parte 2:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="150_Part2Marker.html">Parte 2: Il Mondo Object-Oriented</a></li>
<li class="toctree-l1"><a class="reference internal" href="160_Composable_Design.html">La Componibilità degli Oggetti</a></li>
<li class="toctree-l1"><a class="reference internal" href="170_TellDoNotAsk.html"><span class="xref myst">Raccontare, non chiedere</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="180_Web_of_objects_explained.html">La necessità degli oggetti mock</a></li>
<li class="toctree-l1"><a class="reference internal" href="190_Why_do_we_need_composability.html">Perché abbiamo bisogno della componibilità?</a></li>
<li class="toctree-l1"><a class="reference internal" href="200_What_does_it_mean_to_compose_objects.html">Reti, messaggi e protocolli</a></li>
<li class="toctree-l1"><a class="reference internal" href="210_How_are_objects_composed.html">Comporre una rete di oggetti</a></li>
<li class="toctree-l1"><a class="reference internal" href="211_When_are_objects_composed.html">Quando vengono composti gli oggetti?</a></li>
<li class="toctree-l1"><a class="reference internal" href="212_How_are_the_connections_made.html">Come fa un mittente ad ottenere un riferimento a un destinatario (cioè come vengono stabilite le connessioni)?</a></li>
<li class="toctree-l1"><a class="reference internal" href="213_Where_are_objects_composed.html">Dove vengono composti gli oggetti?</a></li>
<li class="toctree-l1"><a class="reference internal" href="220_Designing_for_composabiity_interfaces.html">Interfacce</a></li>
<li class="toctree-l1"><a class="reference internal" href="230_Designing_for_composabiity_protocols.html">Protocolli</a></li>
<li class="toctree-l1"><a class="reference internal" href="235_Classes.html">Le Classi</a></li>
<li class="toctree-l1"><a class="reference internal" href="240_Refactoring_Object_Composition.html">Composizione di Oggetti come Linguaggio</a></li>
<li class="toctree-l1"><a class="reference internal" href="250_Value_Objects.html">Gli <em>Oggetti Valore</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="255_Value_Objects_properties.html">Anatomia del <em>oggetto valore</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="257_Value%20objects_general_topics.html">Aspetti del design degli <em>oggetti valore</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Oggetti di Trasferimento Dati</a></li>
<li class="toctree-l1"><a class="reference internal" href="#decoupling-by-abstracting-behavior">Disaccoppiamento mediante l'astrazione del comportamento</a></li>
<li class="toctree-l1"><a class="reference internal" href="#decoupling-by-abstracting-data">Disaccoppiamento mediante l'astrazione dei dati</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#issues-with-data-oriented-decoupling">Problemi con il disaccoppiamento orientato ai dati</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#use-both">Usare entrambi</a></li>
<li class="toctree-l1"><a class="reference internal" href="#dto-as-data-centric-decoupling-mechanism">DTO come meccanismo di disaccoppiamento incentrato sui dati</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parte 3:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="260_Part3Marker.html">Parte 3: TDD nel Mondo Object-Oriented</a></li>
<li class="toctree-l1"><a class="reference internal" href="270_Mock_Objects.html">Oggetti Mock come strumento di test</a></li>
<li class="toctree-l1"><a class="reference internal" href="280_Start_with_a_failing_test_mocks.html">Test-first  [<em>Testare prima</em>] utilizzando oggetti mock</a></li>
<li class="toctree-l1"><a class="reference internal" href="290_NeedDrivenDevelopment.html">Il test-driving ai confini di input</a></li>
<li class="toctree-l1"><a class="reference internal" href="300_NeedDrivenRetrospective1.html">Il test-driving ai confini di input -- una retrospettiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="310_Test_Driving_Factories.html">Creazione di oggetti &quot;test-driving&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="320_Test_Driving_Factories_retrospective.html">Creazione di oggetti &quot;test-driving&quot; -- una retrospettiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="330_Test-Driving_Command.html">Logica dell'applicazione test-driving</a></li>
<li class="toctree-l1"><a class="reference internal" href="340_Test-Driving_Value_object.html"><em>Oggetti valore</em> nel test-driving</a></li>
<li class="toctree-l1"><a class="reference internal" href="350_Web_of_objects_boundaries.html">Raggiungere la rete dei confini degli oggetti</a></li>
<li class="toctree-l1"><a class="reference internal" href="360_Internals.html">Cosa c'è dentro l'oggetto?</a></li>
<li class="toctree-l1"><a class="reference internal" href="370_Design_smells.html">Odori del design visibile nella Specifica</a></li>
<li class="toctree-l1"><a class="reference internal" href="End.html">QUESTO È TUTTO QUELLO CHE HO PER ORA. QUELLO CHE SEGUE È MATERIALE GREZZO, NON ORDINATO, NON ANCORA PRONTO PER ESSERE CONSUMATO COME PARTE DI QUESTO TUTORIAL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parte 5:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html">Mock di oggetti come strumento di progettazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#guidance-of-test-smells">Guidaa ai test smells [<em>puzzolenti</em>]</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#revisiting-topics-from-chapter-1">Rivedere gli argomenti del capitolo 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#maintainable-mock-based-statements">Statement manutenibili basate su mock</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#refactoring-mock-code">Refactoring del codice mock</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#part-4-application-architecture">Parte 4: Architettura dell'applicazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#on-stable-architectural-boundaries">Sui confini stabili/architetturali</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#ports-and-adapters">[Port] e adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#what-goes-into-application">Cosa entra in applicazione?</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#what-goes-into-ports">Cosa va nei [port]?</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#part-5-tdd-on-application-architecture-level">Parte 5: TDD a livello di architettura applicativa</a></li>
<li class="toctree-l1"><a class="reference internal" href="400_Dealing_with_3rd_party.html#designing-automation-layer">Progettazione del layer di automazione</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parte 9:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="990_Further_reading.html"><span class="xref myst">Ulteriori Letture</span></a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="257_Value%20objects_general_topics.html" title="capitolo precedente">Aspetti del design degli <em>oggetti valore</em></a></li>
      <li>Next: <a href="260_Part3Marker.html" title="capitolo successivo">Parte 3: TDD nel Mondo Object-Oriented</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Ricerca veloce</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Vai" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Grzegorz GaÅ‚Ä™zowski.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/manuscript/259_DataTransferObjects.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>